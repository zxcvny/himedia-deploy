# projects, environments → 여러 서비스를 하나로 묶어주는 역할
projects: 
  - name: My-app 
    environments: 
      - name: production
        databases:
          - name: postgres-db
            plan: free
            region: singapore
        services: 
          - type: web 
            name: fastapi-server 
            runtime: docker 
            region: singapore
            plan: free
            branch: main
            rootDir: backend
            dockerfilePath: ./Dockerfile
            dockerContext: .
            # 환경변수: DB URL, react server의 호스트 이름 → CORS 
            envVars: 
              - key: DB_URL
                fromDatabase: 
                  name: postgres-db
                  property: connectionString
              - key: REACT_HOST
                fromService: 
                  type: web
                  name: react-server
                  property: host
            autoDeploy: true

          - type: web 
            name: react-server
            runtime: docker
            region: singapore
            plan: free
            branch: main
            rootDir: frontend 
            dockerfilePath: ./Dockerfile
            dockerContext: .
            envVars: 
              - key: VITE_FASTAPI_HOST
                fromService: 
                  type: web
                  name: fastapi-server
                  property: host
            autoDeploy: true